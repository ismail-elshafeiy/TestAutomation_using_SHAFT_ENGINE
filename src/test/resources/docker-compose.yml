# https://github.com/SeleniumHQ/docker-selenium
# Set ExecutionPlatform.properties ,  "localhost:4444" , "Linux-64" and "headlessExecution"
# Set TestNG.properties , "setParallel" and "setThreadCount".
# Set Reporting.properties , "disable" generate Report. After Execution You should open the report manually from"generate_allure_report.bat".
# To execute this docker-compose yml file use `docker-compose -f docker-compose.yml up --scale chrome=4 --scale edge=0 --scale firefox=0 --remove-orphans`
# Add the `-d` flag at the end for detached execution and docker Log
# Open http://localhost:4444/grid/console to see the actions
# To stop the execution, hit Ctrl+C, and then `docker-compose -f docker-compose.yml down --remove-orphans -d`

version: '3.7'

services:
  selenium-hub:

    image: selenium/hub:3.141.59-20200515

    ports:
      - 4444:4444

    environment:

      GRID_MAX_SESSION: 5
      GRID_BROWSER_TIMEOUT: 300
      GRID_TIMEOUT: 300

  chrome:
    image: selenium/node-chrome:3.141.59-20200515

    depends_on:
      - selenium-hub

    shm_size: 2gb
    volumes:

      - /dev/shm:/dev/shm
    environment:
      HUB_HOST: selenium-hub
      HUB_PORT: 4444
      SCREEN_WIDTH: 1920
      SCREEN_HEIGHT: 1080
      # set false for headless execution
      START_XVFB: "false"
      NODE_MAX_SESSION: 1
      NODE_MAX_INSTANCES: 1

#   firefox:

#      image: selenium/node-firefox:3.141.59-20200515

#      depends_on:

#      - selenium-hub

#      shm_size: 2gb

#      volumes:

#      - /dev/shm:/dev/shm

#      environment:

#         HUB_HOST: selenium-hub

#         HUB_PORT: 4444

#         SCREEN_WIDTH: 1920

#         SCREEN_HEIGHT: 1080

## set false for headless execution

#         START_XVFB: "false"

#         NODE_MAX_SESSION: 1

#         NODE_MAX_INSTANCES: 1